<!-- Navbar -->
<header class="header">
  <nav class="navbar navbar-default navbar-static-top navbar-fixed-top" role="navigation">
    <div class="container-fluid">

      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        {{#link-to 'index' class="navbar-brand"}}
            <div class="logo-KPCC"></div>
            <span>Audio Aggregator</span>
        {{/link-to}}
        
      </div>

      <div class="audio-player pull-left">
        <i class="fa fa-play active"></i>
        <i class="fa fa-pause"></i>
        <span class="player-title">
            <b>Now Playing:</b>
            <span></span>
        </span>
        <audio id="player" controls="controls">
          <source id="mp3_src" src="" type="audio/mp3" />
          Your browser does not support the audio element.
        </audio>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse navbar-ex1-collapse">
    
        <ul class="nav navbar-nav navbar-right">
          <li class="dropdown user user-menu">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="glyphicon glyphicon-user"></i>
                  <span>Jane Doe <i class="caret"></i></span>
              </a>
              <ul class="dropdown-menu">
                  <!-- User image -->
                  <li class="user-header bg-light-blue">
                      <p>
                          Jane Doe - Web Developer
                          <small>Member since Nov. 2012</small>
                      </p>
                  </li>
                  <!-- Menu Footer-->
                  <li class="user-footer">
                      <div class="pull-left">
                          <a href="#" class="btn btn-default btn-flat">Profile</a>
                      </div>
                      <div class="pull-right">
                          <a href="#" class="btn btn-default btn-flat">Sign out</a>
                      </div>
                  </li>
              </ul>
          </li>
        </ul>
      </div><!-- /.navbar-collapse -->

    </div>
  </nav>
</header>

<div class="wrapper">

  {{outlet}}
  {{outlet modal}}
  
</div>


<script>
  $(function() {

    // Hook up audio links to pass src to global <audio> element.
    // This is gross and should be reimplemented to follow Ember conventions if the app graduates from being just a prototype.   
    $('.track').click(function(e){
        e.preventDefault();

        load_track = $(this).attr('data-audio'); //gets me the url of the new track
        change_track(load_track); // function to change the track of the loaded audio player without page refresh preferred...

        var track_title = $(this).attr('data-title');
        $('.player-title span').text(track_title);

        $('.fa-play').removeClass('active');
        $('.fa-pause').addClass('active');
    });

    $('.fa-pause').click(function(e){
      var audio = $("#player");
      audio[0].pause();
      $('.fa-pause').removeClass('active');
      $('.fa-play').addClass('active');
    });

    $('.fa-play').click(function(e){
      var audio = $("#player");
      audio[0].play();
      $('.fa-play').removeClass('active');
      $('.fa-pause').addClass('active');
    });

    function change_track(sourceUrl) {
        var audio = $("#player");      
        $("#mp3_src").attr("src", sourceUrl);
        /****************/
        audio[0].pause();
        audio[0].load();//suspends and restores all audio element
        audio[0].play();
        /****************/

        // Reset UI when current audio ends.
        audio[0].addEventListener('ended',function(){
          $('.fa-pause').removeClass('active');
          $('.fa-play').addClass('active');
        });
    }

  });
</script>